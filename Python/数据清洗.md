---
author: "李昌"
title: "数据集的清洗"
date: "2021-02-25"
tags: ["Python"]
categories: ["Python"]
ShowToc: true
TocOpen: true
---

# 数据集的清洗

## 一、一般数据集的处理

### 1、读取

首先创建文件对象，然后进行读取，两种写法


```python
# 第一种
f = open('./Chinese.txt', 'r') # 节选自：《父亲》（朱自清）
article = [] # 创建一个列表
for l in f.readlines():
    article.append(l)
article
```




    ['我说道，“爸爸，你走吧。”他望车外看了看，说，“我买几个橘子去。你就在此地，不要走动。”我看那边月台的栅栏外有几个卖东西的等着顾客。走到那边月台，须穿过铁道，须跳下去又爬上去。父亲是一个胖子，走过去自然要费事些。我本来要去的，他不肯，只好让他去。我看见他戴着黑布小帽，穿着黑布大马褂，深青布棉袍，蹒跚地走到铁道边，慢慢探身下去，尚不大难。可是他穿过铁道，要爬上那边月台，就不容易了。他用两手攀着上面，两脚再向上缩；他肥胖的身子向左微倾，显出努力的样子。这时我看见他的背影，我的泪很快地流下来了。我赶紧拭干了泪，怕他看见，也怕别人看见。我再向外看时，他已抱了朱红的橘子望回走了。过铁道时，他先将橘子散放在地上，自己慢慢爬下，再抱起橘子走。到这边时，我赶紧去搀他。他和我走到车上，将橘子一股脑儿放在我的皮大衣上。于是扑扑衣上的泥土，心里很轻松似的，过一会说，“我走了；到那边来信！”我望着他走出去。他走了几步，回过头看见我，说，“进去吧，里边没人。”等他的背影混入来来往往的人里，再找不着了，我便进来坐下，我的眼泪又来了。']




```python
# 第二种
article = [] # 创建一个列表
with open('./Chinese.txt', 'r') as file_project:
    for l in file_project.readlines():
        article.append(l)
article
```




    ['我说道，“爸爸，你走吧。”他望车外看了看，说，“我买几个橘子去。你就在此地，不要走动。”我看那边月台的栅栏外有几个卖东西的等着顾客。走到那边月台，须穿过铁道，须跳下去又爬上去。父亲是一个胖子，走过去自然要费事些。我本来要去的，他不肯，只好让他去。我看见他戴着黑布小帽，穿着黑布大马褂，深青布棉袍，蹒跚地走到铁道边，慢慢探身下去，尚不大难。可是他穿过铁道，要爬上那边月台，就不容易了。他用两手攀着上面，两脚再向上缩；他肥胖的身子向左微倾，显出努力的样子。这时我看见他的背影，我的泪很快地流下来了。我赶紧拭干了泪，怕他看见，也怕别人看见。我再向外看时，他已抱了朱红的橘子望回走了。过铁道时，他先将橘子散放在地上，自己慢慢爬下，再抱起橘子走。到这边时，我赶紧去搀他。他和我走到车上，将橘子一股脑儿放在我的皮大衣上。于是扑扑衣上的泥土，心里很轻松似的，过一会说，“我走了；到那边来信！”我望着他走出去。他走了几步，回过头看见我，说，“进去吧，里边没人。”等他的背影混入来来往往的人里，再找不着了，我便进来坐下，我的眼泪又来了。']



### 2、把每一句单独放在一行，并去除标点


```python
# 首先读取到字符串
article = '' # 创建一个字符串
with open('./Chinese.txt', 'r') as file_project:
    for l in file_project.readlines():
        article += l
article
```




    '我说道，“爸爸，你走吧。”他望车外看了看，说，“我买几个橘子去。你就在此地，不要走动。”我看那边月台的栅栏外有几个卖东西的等着顾客。走到那边月台，须穿过铁道，须跳下去又爬上去。父亲是一个胖子，走过去自然要费事些。我本来要去的，他不肯，只好让他去。我看见他戴着黑布小帽，穿着黑布大马褂，深青布棉袍，蹒跚地走到铁道边，慢慢探身下去，尚不大难。可是他穿过铁道，要爬上那边月台，就不容易了。他用两手攀着上面，两脚再向上缩；他肥胖的身子向左微倾，显出努力的样子。这时我看见他的背影，我的泪很快地流下来了。我赶紧拭干了泪，怕他看见，也怕别人看见。我再向外看时，他已抱了朱红的橘子望回走了。过铁道时，他先将橘子散放在地上，自己慢慢爬下，再抱起橘子走。到这边时，我赶紧去搀他。他和我走到车上，将橘子一股脑儿放在我的皮大衣上。于是扑扑衣上的泥土，心里很轻松似的，过一会说，“我走了；到那边来信！”我望着他走出去。他走了几步，回过头看见我，说，“进去吧，里边没人。”等他的背影混入来来往往的人里，再找不着了，我便进来坐下，我的眼泪又来了。'




```python
# 使用replace函数，将标点替换为换行符
result_1  = article.replace('，','\n').\
                   replace('“', '').\
                   replace('”', '').\
                   replace('！', '\n').\
                   replace('。', '\n').\
                   replace('；', '')
with open('./result.txt', 'w') as file_project:
    file_project.write(result_1)
file_project.close()
result_1
```




    '我说道\n爸爸\n你走吧\n他望车外看了看\n说\n我买几个橘子去\n你就在此地\n不要走动\n我看那边月台的栅栏外有几个卖东西的等着顾客\n走到那边月台\n须穿过铁道\n须跳下去又爬上去\n父亲是一个胖子\n走过去自然要费事些\n我本来要去的\n他不肯\n只好让他去\n我看见他戴着黑布小帽\n穿着黑布大马褂\n深青布棉袍\n蹒跚地走到铁道边\n慢慢探身下去\n尚不大难\n可是他穿过铁道\n要爬上那边月台\n就不容易了\n他用两手攀着上面\n两脚再向上缩他肥胖的身子向左微倾\n显出努力的样子\n这时我看见他的背影\n我的泪很快地流下来了\n我赶紧拭干了泪\n怕他看见\n也怕别人看见\n我再向外看时\n他已抱了朱红的橘子望回走了\n过铁道时\n他先将橘子散放在地上\n自己慢慢爬下\n再抱起橘子走\n到这边时\n我赶紧去搀他\n他和我走到车上\n将橘子一股脑儿放在我的皮大衣上\n于是扑扑衣上的泥土\n心里很轻松似的\n过一会说\n我走了到那边来信\n我望着他走出去\n他走了几步\n回过头看见我\n说\n进去吧\n里边没人\n等他的背影混入来来往往的人里\n再找不着了\n我便进来坐下\n我的眼泪又来了\n'



### 3、去除常见词 && 分词
（此处把出现次数最多的5个字作为停用词去除）


```python
# 首先做字符出现次数统计
word_count = {} # 初始化一个字典，用于储存字符出现次数
# 首先去除标点符号
result_2  = article.replace('，','').\
                   replace('“', '').\
                   replace('”', '').\
                   replace('！', '').\
                   replace('。', '').\
                   replace('；', '')
for w in result_2:
    word_count.setdefault(w, 0)
    word_count[w] += 1
sorted(word_count.items(), key=lambda k:k[1], reverse=True) 
#排序后原字典不变
# word_count

```




    [('我', 17),
     ('他', 16),
     ('的', 14),
     ('走', 11),
     ('了', 10),
     ('去', 10),
     ('看', 9),
     ('子', 8),
     ('上', 8),
     ('边', 7),
     ('来', 7),
     ('着', 6),
     ('过', 6),
     ('道', 5),
     ('橘', 5),
     ('不', 5),
     ('到', 5),
     ('下', 5),
     ('见', 5),
     ('说', 4),
     ('地', 4),
     ('要', 4),
     ('那', 4),
     ('铁', 4),
     ('慢', 4),
     ('再', 4),
     ('时', 4),
     ('望', 3),
     ('外', 3),
     ('几', 3),
     ('个', 3),
     ('在', 3),
     ('月', 3),
     ('台', 3),
     ('穿', 3),
     ('爬', 3),
     ('是', 3),
     ('一', 3),
     ('布', 3),
     ('大', 3),
     ('向', 3),
     ('泪', 3),
     ('人', 3),
     ('里', 3),
     ('爸', 2),
     ('你', 2),
     ('吧', 2),
     ('车', 2),
     ('就', 2),
     ('等', 2),
     ('须', 2),
     ('又', 2),
     ('胖', 2),
     ('自', 2),
     ('黑', 2),
     ('身', 2),
     ('两', 2),
     ('；', 2),
     ('出', 2),
     ('这', 2),
     ('背', 2),
     ('影', 2),
     ('很', 2),
     ('赶', 2),
     ('紧', 2),
     ('怕', 2),
     ('抱', 2),
     ('回', 2),
     ('将', 2),
     ('放', 2),
     ('衣', 2),
     ('扑', 2),
     ('进', 2),
     ('往', 2),
     ('买', 1),
     ('此', 1),
     ('动', 1),
     ('栅', 1),
     ('栏', 1),
     ('有', 1),
     ('卖', 1),
     ('东', 1),
     ('西', 1),
     ('顾', 1),
     ('客', 1),
     ('跳', 1),
     ('父', 1),
     ('亲', 1),
     ('然', 1),
     ('费', 1),
     ('事', 1),
     ('些', 1),
     ('本', 1),
     ('肯', 1),
     ('只', 1),
     ('好', 1),
     ('让', 1),
     ('戴', 1),
     ('小', 1),
     ('帽', 1),
     ('马', 1),
     ('褂', 1),
     ('深', 1),
     ('青', 1),
     ('棉', 1),
     ('袍', 1),
     ('蹒', 1),
     ('跚', 1),
     ('探', 1),
     ('尚', 1),
     ('难', 1),
     ('可', 1),
     ('容', 1),
     ('易', 1),
     ('用', 1),
     ('手', 1),
     ('攀', 1),
     ('面', 1),
     ('脚', 1),
     ('缩', 1),
     ('肥', 1),
     ('左', 1),
     ('微', 1),
     ('倾', 1),
     ('显', 1),
     ('努', 1),
     ('力', 1),
     ('样', 1),
     ('快', 1),
     ('流', 1),
     ('拭', 1),
     ('干', 1),
     ('也', 1),
     ('别', 1),
     ('已', 1),
     ('朱', 1),
     ('红', 1),
     ('先', 1),
     ('散', 1),
     ('己', 1),
     ('起', 1),
     ('搀', 1),
     ('和', 1),
     ('股', 1),
     ('脑', 1),
     ('儿', 1),
     ('皮', 1),
     ('于', 1),
     ('泥', 1),
     ('土', 1),
     ('心', 1),
     ('轻', 1),
     ('松', 1),
     ('似', 1),
     ('会', 1),
     ('信', 1),
     ('步', 1),
     ('头', 1),
     ('没', 1),
     ('混', 1),
     ('入', 1),
     ('找', 1),
     ('便', 1),
     ('坐', 1),
     ('眼', 1)]




```python
# 提取出出现次数最多的字符作为停用词
stop_words = []
count = 5
# print(word_count)
sorted_dict = sorted(word_count.items(), key=lambda k:k[1], reverse=True)
stop_words = []
for i in range(5):
    stop_words.append(sorted_dict[i][0])

```


```python
# 分词
import jieba

r_f = open('./result.txt', 'r')
w_f = open('./result_1.txt', 'w')
for row in r_f.readlines():
    line = ''
    for r in row:
        if r in stop_words:
            continue
        else:
            line += r
    words = jieba.cut(line)
    w_f.write(' '.join(words))
```

## 作业： 处理以下课文片段
> 要求：
* 从文件中读取  
* 选取出现次数最多的5个字作为停用词
* 利用jieba分词进行分词处理

真的猛士，敢于直面惨淡的人生，敢于正视淋漓的鲜血。这是怎样的哀痛者和幸福者？然而造化又常常为庸人设计，以时间的流驶，来洗涤旧迹，仅使留下淡红的血色和微漠的悲哀。在这淡红的血色和微漠的悲哀中，又给人暂得偷生，维持着这似人非人的世界。我不知道这样的世界何时是一个尽头！
我们还在这样的世上活着；我也早觉得有写一点东西的必要了。离三月十八日也已有两星期，忘却的救主快要降临了罢，我正有写一点东西的必要了。
（节选自《纪念刘和珍君》（鲁迅））
